# User Acceptance Test (UAT) - Refactor & Alignment

This script verifies the new **Debrief (Default)** vs **Live Companion (Advanced)** modes, ensuring strict separation of concerns and privacy standards.

## Prerequisites
- [ ] Backend is running (`python main.py`) in `/backend`
- [ ] Frontend is running (`npm run electron:dev`) in `/frontend`
- [ ] Microphone is accessible

---

## Test 1: Debrief Mode (Default) Policy Check
**Objective:** Verify that NO live advice is generated by default, and that the system only acts as a passive recorder until the session ends.

### 1. Pre-Flight Setup
1. Launch the App.
2. **Verify:** "NEGOTIATION PRE-FLIGHT" screen appears.
3. **Action:** Select Scenario: **Salary**.
4. **Action:** Ensure "Enable Live Companion" checkbox is **UNCHECKED** (Default state).
5. Click **INITIALIZE SYSTEMS**.

### 2. Session Simulation (Passive)
1. **Action:** Speak phrases that would normally trigger alerts:
   - *"I really need this job, I'll take whatever you offer."* (Weakness)
   - *"That is my final offer, take it or leave it."* (Counterparty Ultimatum)
2. **Observation Window (60 seconds):**
   - **CRITICAL VERIFICATION:** Ensure **NO** advice bubbles, text, or signals appear on the overlay.
   - The UI should show "üé§ LISTENING..." and audio meters moving.
   - Status text should show "Mode: DEBRIEF".

### 3. Conclusion & Analysis
1. Press `Ctrl+Shift+S` to **PAUSE**.
2. Click **"End Session & Save"**.
3. **Action:**
   - Result: **Partially Won**
   - Confidence: **3**
   - Notes: "Testing passive recording."
4. Click **Save Outcome**.
5. **Verify:** Reflection Summary appears after a few seconds.

### 4. Data Verification
1. Go to `Coding/equalizer/sessions/`.
2. Open the latest `.json` file.
3. **Verify:**
   - `negotiation_type`: "Salary"
   - `transcripts`: Contains your spoken text.
   - `advice_given`: Should be an **EMPTY** list `[]`. (Strict Check)
   - `reflection`: Contains generated summary.

---

## Test 2: Live Companion Mode (Opt-In)
**Objective:** Verify that checking the box enables real-time tactical signals.

### 1. Pre-Flight Setup
1. Click "Back" or Restart App.
2. **Action:** Select Scenario: **Renewal**.
3. **Action:** **CHECK** the "Enable Live Companion (Advanced)" box.
4. Click **INITIALIZE SYSTEMS**.
5. **Verify:** UI Status shows "Mode: LIVE".

### 2. Session Simulation (Active)
1. **Action:** Simulate a clear specific tactic from a Counterparty (use your phone or speak in a different voice if possible, or just speak clearly):
   - *"This offer expires at 5 PM today. We have other vendors waiting."* (Urgency/scarcity)
2. **Observation (Wait ~15-20 seconds):**
   - **Verify:** A signal alert appears (e.g., "‚ö†Ô∏è URGENCY DETECTED").
   - **Verify:** It offers 2-3 brief options (e.g., "Ignore the deadline", "Ask for extension").
   - **Verify:** The language is neutral suggestions, NOT commands.

### 3. Conclusion
1. End Session and Save.
2. Check `sessions/*.json` file.
3. **Verify:** `advice_given` list is **NOT** empty this time.

---

## Test 3: Privacy & Local Storage
**Objective:** Verify data stays local.

1. **Investigation:** Check the project root for `sessions/` directory.
2. **Verify:** No data is being sent to external logging services (check terminal logs for suspicious network activity besides OpenAI API calls).
3. **Verify:** Session files are standard JSON and readable.

---

## Test 4: Post-MVP Roadmap Preparation (Outcome Tagging)
**Objective:** Verify outcome tagging persists correctly.

1. Complete any session.
2. In the Outcome Modal, enter specific unique notes: "Refactor UAT Verification 12345".
3. Save.
4. Grep the `sessions/` folder for "Refactor UAT Verification 12345".
5. **Verify:** Exact match found in the correct file.
